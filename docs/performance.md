# Performance

These are benchmarks for sake. The implementation is in a separate repository at [github.com/alajmo/sake-performance](https://github.com/alajmo/sake-performance).

The benchmarks are generated by running each test 10 times and taking an average for each of the following metrics:

- **Elapsed Time**: The elapsed real (wall clock) time (seconds) used by the process
- **CPU**: Percentage of the CPU that this job got (`(user + sys time) / tot time`
- **Memory**: Maximum memory (Megabyte) usage of the process during its lifetime

![time](/img/time-1-short.png)
![time](/img/time-2-short.png)

## Test Case 1

A simple ping.

### Graphs

![time](/img/time-1.png)
![cpu](/img/cpu-1.png)
![mem](/img/mem-1.png)

### Data

Elapsed Time (seconds)

| name | sake | pyinfra | ansible |
| --- | --- | --- | --- |
| 1 | 0.085 | 0.915 | 0.620 |
| 3 | 0.135 | 0.950 | 0.650 |
| 5 | 0.140 | 0.965 | 0.690 |
| 8 | 0.130 | 0.980 | 0.720 |
| 10 | 0.170 | 1.010 | 0.750 |
| 25 | 0.150 | 1.135 | 1.170 |
| 50 | 0.200 | 1.385 | 2.210 |
| 100 | 0.315 | 1.935 | 4.420 |
| 200 | 0.540 | 2.925 | 8.530 |
| 300 | 0.785 | 4.225 | 11.860 |
| 400 | 1.045 | 5.290 | 15.400 |
| 500 | 1.330 | 6.510 | 18.320 |

CPU (%)

| name | sake | pyinfra | ansible |
| --- | --- | --- | --- |
| 1 | 8 | 90 | 86 |
| 3 | 16 | 86 | 96 |
| 5 | 32 | 88 | 106 |
| 8 | 31 | 88 | 118 |
| 10 | 40 | 92 | 125 |
| 25 | 41 | 97 | 151 |
| 50 | 50 | 102 | 267 |
| 100 | 47 | 111 | 288 |
| 200 | 48 | 126 | 284 |
| 300 | 50 | 136 | 270 |
| 400 | 50 | 144 | 262 |
| 500 | 48 | 151 | 254 |

Memory (MB)

| name | sake | pyinfra | ansible |
| --- | --- | --- | --- |
| 1 | 15 | 57 | 54 |
| 3 | 17 | 56 | 54 |
| 5 | 17 | 58 | 54 |
| 8 | 21 | 58 | 54 |
| 10 | 21 | 59 | 54 |
| 25 | 23 | 59 | 57 |
| 50 | 23 | 60 | 57 |
| 100 | 27 | 65 | 56 |
| 200 | 33 | 69 | 60 |
| 300 | 40 | 71 | 67 |
| 400 | 46 | 76 | 67 |
| 500 | 51 | 80 | 73 |

## Test Case 2

The following tasks are ran:

1. Add a user
2. Add a file
3. Copy a file
4. Install htop

Note, after the first command is ran, the subsequent commands won't do anything since the user and files already exists, so all tasks are idempotent.

### Graphs

![time](/img/time-2.png)
![cpu](/img/cpu-2.png)
![mem](/img/mem-2.png)

### Data

Elapsed Time (seconds)

| name | sake | pyinfra | ansible |
| --- | --- | --- | --- |
| 1 | 0.085 | 0.915 | 0.620 |
| 3 | 0.135 | 0.950 | 0.650 |
| 5 | 0.140 | 0.965 | 0.690 |
| 8 | 0.130 | 0.980 | 0.720 |
| 10 | 0.170 | 1.010 | 0.750 |
| 25 | 0.150 | 1.135 | 1.170 |
| 50 | 0.200 | 1.385 | 2.210 |
| 100 | 0.315 | 1.935 | 4.420 |
| 200 | 0.540 | 2.925 | 8.530 |
| 300 | 0.785 | 4.225 | 11.860 |
| 400 | 1.045 | 5.290 | 15.400 |
| 500 | 1.330 | 6.510 | 18.320 |

CPU (%)

| name | sake | pyinfra | ansible |
| --- | --- | --- | --- |
| 1 | 8 | 90 | 86 |
| 3 | 16 | 86 | 96 |
| 5 | 32 | 88 | 106 |
| 8 | 31 | 88 | 118 |
| 10 | 40 | 92 | 125 |
| 25 | 41 | 97 | 151 |
| 50 | 50 | 102 | 267 |
| 100 | 47 | 111 | 288 |
| 200 | 48 | 126 | 284 |
| 300 | 50 | 136 | 270 |
| 400 | 50 | 144 | 262 |
| 500 | 48 | 151 | 254 |

Memory (MB)

| name | sake | pyinfra | ansible |
| --- | --- | --- | --- |
| 1 | 15 | 57 | 54 |
| 3 | 17 | 56 | 54 |
| 5 | 17 | 58 | 54 |
| 8 | 21 | 58 | 54 |
| 10 | 21 | 59 | 54 |
| 25 | 23 | 59 | 57 |
| 50 | 23 | 60 | 57 |
| 100 | 27 | 65 | 56 |
| 200 | 33 | 69 | 60 |
| 300 | 40 | 71 | 67 |
| 400 | 46 | 76 | 67 |
| 500 | 51 | 80 | 73 |
